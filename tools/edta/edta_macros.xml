<macros>
  <xml name="bio_tools">
    <xrefs>
        <xref type="bio.tools">edta</xref>
    </xrefs>
  </xml>
  <xml name="edta_main_param">
      <!-- Genome to TE annotations -->
      <param name="genome" argument="--genome" type="data" format="fasta" label="Genome File" help="The Genome FASTA file"/>
      <param name='species' argument ="--species" type="select" label="Which species should be used for identification of TIR candidates">
          <option value="Others">Others</option>
          <option value="Rice">Rice</option>
          <option value="Maize">Maize</option>
      </param>
      <param name="step" argument="--step" type="select" label="Specify which steps you want to run EDTA" help="all: run the entire pipeline (default) \n filter: start from raw TEs to the end.">
          <option value="all">All</option>
          <option value="filter">Filter</option>
          <option value="final">Final</option>
          <option value="anno">Anno</option>
      </param>
      <param name="cds" argument="--cds" type="data" format="fasta" label="Coding Sequence File" optional='true' help="Provide a FASTA file containing the coding sequence (no introns, UTRs, nor TEs) of this genome or its close relative."/> 
      <param name="curatedlib" argument="--curatedlib" type="data" format="fasta" label="Curated Library File" optional='true' help="Provided a curated library to keep consistant naming and classification for known TEs. All TEs in this file will be trusted 100%, so please ONLY provide MANUALLY CURATED ones here."/>
      <param name="sensitive" argument="--sensitive" type="boolean"  truevalue="1" falsevalue="0"  label="Use RepeatModeler to identify remaining TEs" help="Use RepeatModeler to identify remaining TEs This step is very slow and MAY help to recover some TEs."/>
      <param name="mutation_rate" argument="--u" type="float" optional="True" label="Neutral Mutation Rate" help="Neutral mutation rate to calculate the age of intact LTR elements. Default: 1.3e-8 (per bp per year, from rice)"></param>
      <conditional name='anno_select'>
          <param name="anno" type="select" label="Would you like to perform whole-genome TE annotation after TE library construction?" argument='--a' help='Perform or not perform whole-genome TE annotation after TE library construction.'>
              <option value="yes">Yes</option>
              <option value="no">No</option>
          </param>
          <when value="yes">
              <param name="evaluate" argument="--evaluate" type="boolean" truevalue="1" falsevalue="0" label="Evaluate" help="Evaluate (1) classification consistency of the TE annotation " />
              <param name="exclude" argument="--exclude" type="data" format="bed" label="Exclude" help="Exclude bed format regions from TE annotation" optional="true"/>
          </when>
      </conditional>
  </xml>
  <xml name="pan_edta">
    <!-- Genome to TE annotations -->
    <param name="genome" argument="--genome" type="data" format="fasta" label="Genome File" help="The Genome FASTA file"/>
    <param name='species' argument ="--species" type="select" label="Which species should be used for identification of TIR candidates">
        <option value="Others">Others</option>
        <option value="Rice">Rice</option>
        <option value="Maize">Maize</option>
    </param>
    <param name="cds" argument="--cds" type="data" format="fasta" label="Coding Sequence File" optional='true' help="Provide a FASTA file containing the coding sequence (no introns, UTRs, nor TEs) of this genome or its close relative."/> 
    <param name="curatedlib" argument="--curatedlib" type="data" format="fasta" label="Curated Library File" optional='true' help="Provided a curated library to keep consistant naming and classification for known TEs. All TEs in this file will be trusted 100%, so please ONLY provide MANUALLY CURATED ones here."/>
    <param name="sensitive" argument="--sensitive" type="boolean"  truevalue="1" falsevalue="0"  label="Use RepeatModeler to identify remaining TEs" help="Use RepeatModeler to identify remaining TEs This step is very slow and MAY help to recover some TEs."/>
    <param name="mutation_rate" argument="--u" type="float" optional="True" label="Neutral Mutation Rate" help="Neutral mutation rate to calculate the age of intact LTR elements. Default: 1.3e-8 (per bp per year, from rice)"></param>
    <param name="evaluate" argument="--evaluate" type="boolean" truevalue="1" falsevalue="0" label="evaluate" help="Evaluate (1) classification consistency of the TE annotation " />
    <param name="exclude" argument="--exclude" type="data" format="bed" label="Exclude" help="Exclude bed format regions from TE annotation" optional="true"/>
    
</xml>

<macro name="reference_source_conditional">
    <conditional name="reference_source">
        <param name="reference_source_selector" type="select" label="Will you select a rice reference genome from your history or use a built-in rice genome">
            <option value="cached">Use a built-in genome </option>
            <option value="history">Use a genome from history</option>
        </param>
        <when value="cached">
            <param name="ref_file" type="select" label="Using reference genome" help="Select genome from the list">
                <options from_data_table="bwa_mem_indexes">
                    <filter type="sort_by" column="2" />
                    <validator type="no_options" message="No indexes are available" />
                </options>
                <validator type="no_options" message="A built-in reference genome is not available for the build associated with the selected input file"/>
            </param>
        </when>
        <when value="history">
            <param name="ref_file" type="data" format="fasta" label="Use the following dataset as the reference genome" help="You can upload a FASTA file to the history and use it as reference genome" />
        </when>
    </conditional>
</macro>
</macros>